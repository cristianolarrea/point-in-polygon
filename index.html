<!DOCTYPE html>
<html>
    <head>
        <title>

        </title>
    </head>

    <body>
        <canvas id="canvas" width="200" height="200"></canvas>
        <script>
        var canvas = document.getElementById("canvas");
        var ctx = canvas.getContext("2d");
        var my_polygon = [40,30,60,20,130,80,100,150,70,70,60,120,40,110,40,30];
        var point = [100,100];
        var createPolygon = function(polygon) {
            ctx.moveTo(polygon[0], polygon[1]);
            for (var i=2;i<=polygon.length;i+=2) {
                ctx.lineTo(polygon[i],polygon[i+1]);
            }
            ctx.stroke();
        }
        var plotPoint = function(point) {
            x = point[0]
            y = point[1]
            ctx.fillStyle = "red";
            ctx.moveTo(x,y)
            ctx.fillRect(x,y,2,2);
            ctx.stroke();
        }
        
        createPolygon(my_polygon);
        plotPoint(point);
        intersectionCounter = 0;
        var distance = function(point_1, point_2){
            let y = point_2[0] - point_1[0];
            let x = point_2[1] - point_1[1];
            return Math.sqrt(x*x + y*y)
        }
        var lineSize=0;
        var drawText = function() {
            ctx.fillStyle = "red";
            ctx.fillText("Intersection Count: " + intersectionCounter, 80, 20);
        }
        drawText();
        var updateDrawText = function() {
            ctx.fillStyle="#ffffff"
            ctx.fillRect(80,10,100,20);
            drawText();
        }
        var interval = setInterval(function(){
            ctx.moveTo(0, point[1]);
            ctx.lineTo(lineSize, point[1]);
            ctx.stroke();
            lineSize+=0.01;
            for (i=0; i<=my_polygon.length-4; i+=2) {
               point_1 = [my_polygon[i],my_polygon[i+1]]
               point_2 = [my_polygon[i+2],my_polygon[i+3]]
               current_point = [lineSize,point[1]]
               if ((distance(point_1,current_point)+distance(point_2,current_point))===(distance(point_1,point_2))) {
                   intersectionCounter++;
                   updateDrawText();
                }
           }
            if (lineSize > point[0]) {
                clearInterval(interval);
            }
            console.log(intersectionCounter);
        },1) 
    
        </script>
    </body>
</html>